<!DOCTYPE html>
<html>
<head>
	<!-- http://ios-journey.blogspot.com/2013/05/ipa-distribution-mime-type-for-ipa-and.html -->
    <meta charset="utf-8" />
    <title>Mobile Apps</title>
    <meta name="viewport" content="width=device-width" />
    <link href="Content/Site.Mobile.css" rel="stylesheet"/>
	<link href="Content/bootstrap.css" rel="stylesheet"/>
	<link href="Content/jquery.mobile-1.4.5.css" rel="stylesheet"/>
	<link href="Content/jquery.mobile.external-png-1.4.5.css" rel="stylesheet"/>
	<link href="Content/jquery.mobile.structure-1.4.5.css" rel="stylesheet"/>
	<link href="Content/jquery.mobile.theme-1.4.5.css" rel="stylesheet"/>
	<style>
		body: {
			background-color: white !important;
		}
		.ui-listview > li {
			text-align: center;
			padding: 5px;
		}
		div[data-role="page"] {
			text-align: center; 
			background-color: white;
			padding: 1em;
		}
		li {
			list-style-type: none;
		}
	</style>
	<script src="Scripts/jquery-1.10.2.js"></script>
	<script src="Scripts/jquery.mobile-1.4.5.js"></script>
	<script src="Scripts/mobile-detect-1.3.2.min.js"></script>
	<script>
		$(document).ready(function () {
			$.mobile.ajaxEnabled = false;
			var md = new MobileDetect(window.navigator.userAgent);
			var os = md.os();
			var isMobile = md.mobile();
			
			var osTitle = os == "AndroidOS" ? " for Android" : (os == "iOS" ? " for iPhone" : "");
			if (!isMobile)
				osTitle = " for Desktop";
			$('#os').html(osTitle);
			
			// should download from server
			var allapps = [
				{ 
					Name: "Restroom Finder", 
					AndroidOSLink: "https://your.company.dns/path/to/Mobile.Apps Website/Restroom/Restroom-release-00.00.13-20160722145420.apk", 
					iOSLink: "itms-services://?action=download-manifest&url=https://your.company.dns/path/to/Mobile.Apps Website/Restroom/manifest.plist",
					HelpLink: "https://your.company.dns/path/to/Mobile.Apps Website/Restroom/Help.htm"					
				}
			];
			function addApp(link, name, helpLink){
				var rnd = ((new Date().getTime() * 10000) + 621355968000000000).toString();
				$("#apps").append(
					'<div data-role="collapsible" data-collapsed="true" data-inset="true" class="app">' + 
						'<h4>' + name + '</h4>' + 
						'<ul data-role="listview">' + 
							'<li><a rel="external" href="' + link + '?' + rnd+ '"><div class="ui-btn ui-input-btn ui-shadow">Download<input type="button" data-corners="false" data-enhanced="true"></input></div></a></li>' + 
							'<li><a rel="external" href="' + helpLink + '"><div class="ui-btn ui-input-btn ui-shadow">How to Install<input type="button" data-corners="false" data-enhanced="true"></input></div></a></li>' + 
						'</ul>' +
					'</div>');
			}
			
			allapps.forEach(function(app, index, apps) {
				if ((app.AndroidOSLink) && (os == "AndroidOS")) {
					addApp(app.AndroidOSLink, app.Name, app.HelpLink);
				}
				else {
					if ((app.iOSLink) && (os == "iOS")) {
						addApp(app.iOSLink, app.Name, app.HelpLink);
					}
				}
			});
			$("#apps").collapsibleset("refresh");

		});
    </script>	
</head>
<body>
	<div data-role="page" data-theme="a">
		<img src="Content/Images/logo.gif" />
		<h3>Mobile Apps<span id="os"></span></h3>
		<form>
			<input id="filter-for-listview" data-type="search" placeholder="Type to search...">
		</form>
		<div id="apps" data-role="collapsible-set">
		</div>
	</div>
</body>
</html>
